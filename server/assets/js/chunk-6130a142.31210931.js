(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6130a142"],{"176a":function(e,t,a){},"4e0c":function(e,t,a){e.exports=a.p+"img/scanningTip.0f688bae.png"},"737d":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAYAAADhAJiYAAAAmUlEQVRYR+2YwQmAMBAEvfbswkJ8WYhd2J7iQx8RM7hwIcL6Xe6yDgtZEts674PwjdMStTF1b6iD6YboAAHip5ELzE3Ihgp+JkSBMiETIgKkO0P/JUTOW+vVCtHazHlef4bUPpRFTy5oaYayFqt7+8uQ+idZc66wb2R9uVLmTMiEiADpzpAJEQHSHxmigVKn5xu1+MkFLcvQAUuGxKOvhmvFAAAAAElFTkSuQmCC"},"89cc":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"wrapper"},[a("div",{staticClass:"flex-between bill-info"},[a("div",{staticClass:"flex-box"},[a("p",[e._v(e._s(e.$t("pay.pleasePayInTime")))]),a("p",[e._v(e._s(e.$t("pay.billNumber"))+"："+e._s(e.billCode))])]),a("div",{staticClass:"bill-price"},[e._v("¥"+e._s(e._f("$goldDivide")(e.actuallyPaid)))])]),a("div",{staticClass:"main flex-box"},[a("div",{staticClass:"main-left flex-vbox flex-center"},[a("p",{staticClass:"main-tite"},[e._v(e._s(e.$t("pay.wxPay")))]),a("div",{attrs:{id:"wxqrcode"}},[e.qrcodeDisabled?a("div",{staticClass:"disabled"},[e._v("\n                    "+e._s(e.$t("pay.QRcodeLoseEfficacy"))+"\n                    "),a("span",{staticClass:"refresh-btn",on:{click:e.refreshPage}},[e._v(e._s(e.$t("common.refresh")))]),a("div",{staticClass:"next-step"},[e._v("\n                        "+e._s(e.$t("pay.paySuccessPleaseClick"))+"\n                        "),a("span",{staticClass:"refresh-btn",on:{click:e.nextStep}},[e._v("\n                            "+e._s(e.$t("pay.next"))+"\n                        ")])])]):e._e()]),a("div",{staticClass:"flex-box"},[e._m(0),a("div",{staticClass:"qrcode-tip"},[a("p",[e._v(e._s(e.$t("pay.useWechatScan")))]),a("p",[e._v(e._s(e.$t("pay.useWechatScanToPay")))])])]),a("p",{staticClass:"scannning-desctibe"},[e._v(e._s(e.$t("pay.payRightNow")))])]),a("div",{staticClass:"center-cut"}),e._m(1)])])},i=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("img",{attrs:{src:a("737d"),alt:""}})])},function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"main-right"},[r("img",{attrs:{src:a("4e0c"),alt:""}})])}],n=(a("a481"),a("d044")),s=a.n(n),o=a("ec02"),c=a("22ce"),l={components:{},data:function(){return{payInfo:{},actuallyPaid:0,qrcodeDisabled:!1}},beforeDestroy:function(){this.interval&&clearInterval(this.interval)},methods:{nextStep:function(){var e=this;this.getBillState(this.payInfo.paymentUid).then(function(t){1!=t&&(e.orderType?e.$message.error("订单尚未支付，请先支付"):e.$router.replace("/order-detail?billCode="+e.billCode))})},refreshPage:function(){window.location.reload()},qrCodeInit:function(){new s.a("wxqrcode",{width:280,height:280,text:this.payInfo.qRCode,colorDark:"#000",colorLight:"#fff"})},pollPayState:function(e){var t=this,a=function(){t.getBillState(e),t.pollNum++,t.pollNum*t.pollTime>t.limitTime&&(clearInterval(t.interval),t.qrcodeDisabled=!0)};this.interval=setInterval(function(){a()},this.pollTime)},getBillState:function(e){var t=this;return c["h"].getBillState({paymentUid:e}).then(function(e){return 1==e&&(t.interval&&clearInterval(t.interval),window.location.href=t.successUrl),e})},getWxPayInfo:function(){var e=this;o["a"].wxPay(this,this.billCode,this.actuallyPaid,this.successUrl,this.orderType).then(function(t){e.payInfo=t,e.qrCodeInit(),e.pollPayState(t.paymentUid)},function(t){e.orderType?e.$message.error(e.$t("pay.payError")):e.$router.replace("/pay-state?billCode="+e.billCode+"&payResult=failed&actuallyPaid="+e.actuallyPaid)})}},created:function(){this.pollTime=5e3,this.pollNum=0,this.limitTime=6e4,this.billCode=this.$route.query.billCode,this.actuallyPaid=this.$route.query.actuallyPaid,this.orderType=this.$route.query.orderType;var e=this.$route.query.successUrl;this.successUrl=window.location.origin+"".concat(baseConstant.pathProjectName?"/"+baseConstant.pathProjectName:"")+(e?decodeURIComponent(e):"/pay-state?billCode="+this.billCode+"&payResult=success"+(this.orderType?"&orderType="+this.orderType:"")+(this.actuallyPaid?"&actuallyPaid="+this.actuallyPaid:""))},mounted:function(){this.getWxPayInfo()}},u=l,p=(a("acba"),a("2877")),d=Object(p["a"])(u,r,i,!1,null,"2ac06cb7",null);t["default"]=d.exports},acba:function(e,t,a){"use strict";var r=a("176a"),i=a.n(r);i.a},ec02:function(e,t,a){"use strict";a("c5f6"),a("96cf");var r=a("3b8d"),i=(a("a481"),a("4917"),a("751a"));function n(e,t,a,r,i,n){return s.apply(this,arguments)}function s(){return s=Object(r["a"])(regeneratorRuntime.mark(function e(t,a,r,n,s,o){var c,l;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(r=Number(r),0!==r){e.next=3;break}return e.abrupt("return",r);case 3:return c={usrId:t.Storage.get("USER_INFO").usrId,paymentCode:"D_WEIXIN",tradeTypeCode:"QRCODE",paymentTypeCode:o||"D_FULL",shopCode:t.Storage.get("USER_INFO").shopCode,orderList:a,orderType:s||null,openId:"",payAmount:Number(r),unionId:"",successUrl:n},e.next=6,i["a"].post("payment/orderPayment",c);case 6:if(l=e.sent,"200"!==l.code){e.next=11;break}return e.abrupt("return",l);case 11:return t.$alert(l.message,this.$t("common.hint"),{confirmButtonText:this.$t("common.sure"),callback:function(e){}}),e.abrupt("return",Promise.reject());case 13:case"end":return e.stop()}},e,this)})),s.apply(this,arguments)}function o(e,t,a,r,i,n){return c.apply(this,arguments)}function c(){return c=Object(r["a"])(regeneratorRuntime.mark(function e(t,a,r,n,s,o){var c,l;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(r=Number(r),0!==r){e.next=3;break}return e.abrupt("return",r);case 3:return c={usrId:t.Storage.get("USER_INFO").usrId,paymentCode:"D_ALIPAY",tradeTypeCode:"WEBPAY",paymentTypeCode:o||"D_FULL",shopCode:t.Storage.get("USER_INFO").shopCode,orderList:a,orderType:s||null,openId:"",payAmount:Number(r),unionId:"",successUrl:n},e.next=6,i["a"].post("payment/orderPayment",c);case 6:return l=e.sent,e.abrupt("return",l);case 8:case"end":return e.stop()}},e)})),c.apply(this,arguments)}t["a"]={wxPay:n,aliPay:o}}}]);