(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-edf23b28"],{"0f95":function(e,t,o){"use strict";o.r(t);var n=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"safe-collection"},[n("div",{directives:[{name:"show",rawName:"v-show",value:!e.next,expression:"!next"}],staticClass:"safe-top bg-color-gray color-balck"},[e._v(e._s(e.$t("Mobile.verifyPhone")))]),n("div",{directives:[{name:"show",rawName:"v-show",value:e.next,expression:"next"}],staticClass:"safe-top bg-color-gray color-balck"},[e._v(e._s(e.$t("Mobile.changePhone")))]),n("div",{directives:[{name:"show",rawName:"v-show",value:!e.checkstatus&&!e.next,expression:"!checkstatus && !next"}],staticClass:"check-phone"},[n("el-form",{ref:"Checkphone",attrs:{rules:e.Checkphone,model:e.ruleForm2,"label-width":"130px"}},[n("el-form-item",{attrs:{label:e.$t("Mobile.oldPhone")}},[n("span",{staticClass:"phones",staticStyle:{"font-weight":"600","padding-left":"14px"}},[e._v(e._s(e.ruleForm2.phone.substr(0,3)+"****"+e.ruleForm2.phone.substr(7)))])]),n("el-form-item",{attrs:{label:e.$t("Mobile.verificationCode"),prop:"noteCode"}},[n("el-input",{staticClass:"verifict-input",attrs:{clearable:"",maxlength:"6",placeholder:e.$t("Mobile.inputNotecode"),onkeyup:"this.value=this.value.replace(/[^0-9]/g,'')",onbeforepaste:"clipboardData.setData('text',clipboardData.getData('text').replace(/[^0-9]/g,''))"},nativeOn:{keydown:function(t){return t.type.indexOf("key")||32===t.keyCode?e.keydownEvent(t):null}},model:{value:e.ruleForm2.noteCode,callback:function(t){e.$set(e.ruleForm2,"noteCode",t)},expression:"ruleForm2.noteCode"}}),e.codeflag?n("div",{staticClass:"getCode",on:{click:function(t){return t.stopPropagation(),e.getCheckNumber()}}},[e._v(e._s(e.$t("Mobile.getCode")))]):n("div",{staticClass:"ungetCode"},[e._v(e._s(e.$t("Mobile.agianSend"))+"("+e._s(e.countDownCode)+"s)")])],1),n("el-form-item",[n("el-button",{class:e.isOk?"nextSteps":"unNext",attrs:{type:"primary"},on:{click:function(t){return e.nextStep()}}},[e._v(e._s(e.$t("Mobile.nextStep")))])],1)],1)],1),n("div",{directives:[{name:"show",rawName:"v-show",value:!e.checkstatus&&e.next,expression:"!checkstatus && next"}],staticClass:"change-phone"},[n("el-form",{ref:"changePhone",attrs:{rules:e.changePhone,model:e.ruleForm2,"label-width":"130px"}},[n("el-form-item",{attrs:{label:e.$t("Mobile.newPhone"),prop:"newPhone"}},[n("el-input",{attrs:{maxlength:"11",clearable:"",placeholder:e.$t("Mobile.inputPhone"),onkeyup:"this.value=this.value.replace(/[^0-9]/g,'')",onbeforepaste:"clipboardData.setData('text',clipboardData.getData('text').replace(/[^0-9]/g,''))"},nativeOn:{keydown:function(t){return t.type.indexOf("key")||32===t.keyCode?e.keydownEvent(t):null}},model:{value:e.ruleForm2.newPhone,callback:function(t){e.$set(e.ruleForm2,"newPhone",t)},expression:"ruleForm2.newPhone"}})],1),n("el-form-item",{attrs:{label:e.$t("Mobile.verificationCode"),prop:"noteCode"}},[n("el-input",{staticClass:"verifict-input",attrs:{clearable:"",maxlength:"6",placeholder:e.$t("Mobile.inputNotecode"),onkeyup:"this.value=this.value.replace(/[^0-9]/g,'')",onbeforepaste:"clipboardData.setData('text',clipboardData.getData('text').replace(/[^0-9]/g,''))"},nativeOn:{keydown:function(t){return t.type.indexOf("key")||32===t.keyCode?e.keydownEvent(t):null}},model:{value:e.ruleForm2.noteCode,callback:function(t){e.$set(e.ruleForm2,"noteCode",t)},expression:"ruleForm2.noteCode"}}),e.codeflag?n("div",{class:e.getCode?"getCode":"ungetCode",on:{click:function(t){return t.stopPropagation(),e.checkPhone()}}},[e._v(e._s(e.$t("Mobile.getCode")))]):n("div",{staticClass:"ungetCode"},[e._v(e._s(e.$t("Mobile.agianSend"))+"("+e._s(e.countDownCode)+"s)")])],1),n("el-form-item",[n("el-button",{class:e.isOk?"nextSteps":"unNext",attrs:{type:"primary"},on:{click:function(t){return e.submitForm()}}},[e._v(e._s(e.$t("Mobile.submit")))])],1)],1)],1),n("div",{directives:[{name:"show",rawName:"v-show",value:e.checkstatus,expression:"checkstatus"}],staticClass:"alter-status"},[n("div",[n("img",{attrs:{src:o("2143")}}),n("p",{staticClass:"title"},[e._v(e._s(e.$t("Mobile.alterSuccess"))+" "+e._s(e.ruleForm2.newPhone.substr(0,3)+"****"+e.ruleForm2.newPhone.substr(7)))]),n("p",{staticClass:"location"},[e._v(e._s(e.$t("Mobile.successTips")))])])])])},r=[],s=o("22ce"),i=o("393c"),a={components:{},mixins:[i["a"]],data:function(){return{codeflag:!0,ruleForm2:{phone:"",newPhone:"",noteCode:""},Checkphone:{noteCode:[{validator:this.validateVerificationCode,trigger:"blur"}]},changePhone:{newPhone:[{validator:this.validatePhone,trigger:"blur"}],noteCode:[{validator:this.validateVerificationCode,trigger:"blur"}]},countDownCode:0,next:!1,checkstatus:!1,isOk:!1,getCode:!1,btnLock:!1}},watch:{ruleForm2:{handler:function(e){this.ruleForm2.phone&&this.ruleForm2.noteCode.length>0?this.isOk=!0:this.isOk=!1,0!=this.ruleForm2.newPhone.length?(/^1[345789]\d{9}$/.test(this.ruleForm2.newPhone)?this.getCode=!0:this.getCode=!1,this.getCode&&this.ruleForm2.noteCode.length>0?this.isOk=!0:this.isOk=!1):this.getCode=!1},deep:!0}},methods:{keydownEvent:function(e){return e.preventDefault(),!1},getPhone:function(){var e=this,t={};s["l"].getUserInfo(t).then(function(t){console.log(t),e.ruleForm2.phone=t.mobilePhone})},checkPhone:function(){var e=this;if(this.ruleForm2.newPhone&&/^1[345789]\d{9}$/.test(this.ruleForm2.newPhone)){var t={id:Storage.get("USER_INFO").usrId,mobile:this.ruleForm2.newPhone,ownCompanyId:Storage.get("COMPANYID").company_id};s["l"].checkPhone(t).then(function(t){e.getCheckNumber()},function(t){e.$message.error(t.errorMsg)})}},getCheckNumber:function(){var e=this;if(!this.btnLock){var t;this.btnLock=!0,t=0==this.next?this.ruleForm2.phone:this.ruleForm2.newPhone;var o={mobile:t,id:Storage.get("USER_INFO").usrId,verifyClassCode:"VERIFY_CHANGE_MOBILE"};s["l"].getCaptcha(o).then(function(t){"03"==t||"OK"==t?(e.countDownCode=60,e.codeflag=!1,e.countDown=setInterval(function(){e.countDownCode--,e.countDownCode<=0&&(e.codeflag=!0,e.btnLock=!1,clearInterval(e.countDown))},1e3),e.$message(e.$t("Mobile.sendNote"))):(e.btnLock=!1,e.$message.error(e.$t("Mobile.failNote")))})}},nextStep:function(){var e=this;this.$refs.Checkphone.validate(function(t){if(!t)return!1;var o={mobilePhone:e.ruleForm2.phone,registCode:e.ruleForm2.noteCode,onlyVerify:1,verifyType:null,verifyClassCode:"VERIFY_CHANGE_MOBILE"};s["l"].checkCaptcha(o).then(function(t){e.next=!0,e.ruleForm2.noteCode="",e.ruleForm2.phone="",e.countDownCode=0,console.log(t)},function(t){t.errorMsg&&e.$message.error(t.errorMsg)})})},submitForm:function(){var e=this;this.$refs.changePhone.validate(function(t){if(!t)return!1;var o={mobilePhone:e.ruleForm2.newPhone,registCode:e.ruleForm2.noteCode,onlyVerify:"",verifyType:null,verifyClassCode:"VERIFY_CHANGE_MOBILE"};s["l"].checkCaptcha(o).then(function(t){var o={newMobile:e.ruleForm2.newPhone,oldMobile:e.ruleForm2.phone};s["l"].changePhone(o).then(function(t){e.checkstatus=!0,e.$store.dispatch("user/updateUserInfo"),setTimeout(function(){e.$router.push("/safe-list")},3e3)},function(e){})},function(t){t.errorMsg&&(console.log(t.errorMsg),e.$message.error(t.errorMsg))})})}},created:function(){this.getPhone()}},l=a,c=(o("68cb"),o("2877")),u=Object(c["a"])(l,n,r,!1,null,"56532090",null);t["default"]=u.exports},2143:function(e,t,o){e.exports=o.p+"img/success.5e63e7cf.png"},"393f":function(e,t,o){},"68cb":function(e,t,o){"use strict";var n=o("393f"),r=o.n(n);r.a}}]);